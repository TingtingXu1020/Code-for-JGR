function P = Hill(a, c, bm, sm)
X = c/a;
if X == 1 % spherical shape
    type = 1;
else
    if X < 1e-3 %penny shape
        type = 2;
    else % Oblate spheroid
        type = 3;
    end
end
nu= (3*bm - 2*sm)/2/(3*bm + sm);
E = 9*bm*sm/(3*bm + sm);
S = zeros(3, 3, 3, 3);
switch type
    case 1
        %% spherical shape (a1=a2=a3)        
       S(1, 1, 1, 1) = (7-5*nu)/15/(1-nu);
       S(2, 2, 2, 2) = S(1, 1, 1, 1);
       S(3, 3, 3, 3) = S(1, 1, 1, 1) ;
       S(1, 1, 2, 2) = (5*nu- 1)/15/(1-nu);
       S(2, 2, 3, 3) = S(1, 1, 2, 2);
       S(3, 3, 1, 1) = S(1, 1, 2, 2);
       S(1, 1, 3, 3) = S(1, 1, 2, 2);
       S(2, 2, 1, 1) = S(1, 1, 2, 2);
       S(3, 3, 2, 2) = S(1, 1, 2, 2);
       S(1, 2, 1, 2) = (4-5*nu)/15/(1-nu);
       S(2, 3, 2, 3) = S(1, 2, 1, 2);
       S(3, 1, 3, 1) = S(1, 2, 1, 2);
        
        %% penny shape (a1=a2>>a3)
        % a3->0
        % I1 = 0; I2 = 0; I3 = 4*pi;
        % I12 = 0; I23 = 4*pi/a^2; I31 = 4*pi/a^2;
        % I11 = 0; I22 = 0; c2I33 = 4*pi/3;
    case 2
        
        S(1,1,1,1) = (13-8*nu)/32/(1-nu)*pi*X;
        S(2,2,2,2) = S(1,1,1,1);
        S(3,3,3,3) = 1 - (1-2*nu)/(1-nu)*pi/4*X;
        
        S(1,1,2,2) = (8*nu-1)/32/(1-nu)*pi*X;
        S(2,2,1,1) = S(1,1,2,2);
        
        S(1,1,3,3) = (2*nu-1)/8/(1-nu)*pi*X;
        S(2,2,3,3) = S(1,1,3,3);
        
        S(3,3,1,1) = nu/(1-nu)*(1-(4*nu+1)/8/nu*pi*X);
        S(3,3,2,2) = S(3,3,1,1);
        S(1,2,1,2) = (7-8*nu)/32/(1-nu)*pi*X;
        
        S(1,3,1,3) = 1/2*(1 + (nu-2)/(1-nu)*pi/4*X);
        S(2,3,2,3) = S(1,3,1,3);
        
        S(2,1,2,1) = S(1,2,1,2);
        S(1,2,2,1) = S(1,2,1,2);
        S(2,1,1,2) = S(1,2,1,2);
        
        S(3,1,3,1) = S(1,3,1,3); 
        S(3,1,1,3) = S(1,3,1,3); 
        S(1,3,3,1) = S(1,3,1,3); 
        
        S(2,3,3,2) = S(2,3,2,3); 
        S(3,2,3,2) = S(2,3,2,3); 
        S(3,2,2,3) = S(2,3,2,3); 
        
        
        
        
        
        %% Oblate spheroid (a1=a2>a3) Ref. Mura. p84
    case 3
        I1 = 2*pi*a^2*c/(a^2-c^2)^(3/2)*(acos(X)-X*(1-c^2/a^2)^(1/2));
        I2 = I1;
        I3 = 4*pi - 2*I1;
        I12 = pi/a^2 - (I1 - I3)/4/(c^2 - a^2);
        I21 = I12;
        I11 = I12;
        I22 = I12;
        I13 = (I1 - I3)/(c^2 - a^2);
        I23 = I13;
        I31 = I13;
        I32 = I23;
        I33 = (4*pi/c^2 - 2*I13)/3;
        S = zeros(3,3,3,3);
        S(1,1,1,1) = 3/8/pi/(1-nu)*a^2*I11 + (1-2*nu)/8/pi/(1-nu)*I1;
        S(1,1,2,2) = 1/8/pi/(1-nu)*a^2*I12 - (1-2*nu)/8/pi/(1-nu)*I1;
        S(1,1,3,3) = 1/8/pi/(1-nu)*c^2*I13 - (1-2*nu)/8/pi/(1-nu)*I1;
        S(1,2,1,2) = (2*a^2)/16/pi/(1-nu)*I12 + (1-2*nu)/16/pi/(1-nu)*(I1+I2);
        
        
        S(2,2,1,1) = 1/8/pi/(1-nu)*a^2*I21 - (1-2*nu)/8/pi/(1-nu)*I2;
        S(2,2,2,2) = 3/8/pi/(1-nu)*a^2*I22 + (1-2*nu)/8/pi/(1-nu)*I2;
        S(2,2,3,3) = 1/8/pi/(1-nu)*c^2*I23 - (1-2*nu)/8/pi/(1-nu)*I2;
        S(2,3,2,3) = (a^2 + c^2)/16/pi/(1-nu)*I23 + (1-2*nu)/16/pi/(1-nu)*(I2+I3);
        
        S(3,3,1,1) = 1/8/pi/(1-nu)*a^2*I31 - (1-2*nu)/8/pi/(1-nu)*I3;
        S(3,3,2,2) = 1/8/pi/(1-nu)*a^2*I32 - (1-2*nu)/8/pi/(1-nu)*I3;
        S(3,3,3,3) = 3/8/pi/(1-nu)*c^2*I33 + (1-2*nu)/8/pi/(1-nu)*I3;
        S(3,1,3,1) = (a^2 + c^2)/16/pi/(1-nu)*I31 + (1-2*nu)/16/pi/(1-nu)*(I1+I3);
        
        S(1,2,2,1) = S(1,2,1,2);
        S(2,1,2,1) = S(1,2,1,2);
        S(2,1,1,2) = S(1,2,1,2);
        
        S(1,3,3,1) = S(3,1,3,1) ;
        S(1,3,1,3) = S(3,1,3,1) ;
        S(3,1,1,3) = S(3,1,3,1) ;
        
        S(3,2,2,3) = S(2,3,2,3);
        S(2,3,3,2) = S(2,3,2,3);
        S(3,2,3,2) = S(2,3,2,3);
end

P = doubledotff(S, Intactcompliance(E, nu));

end